<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat UI Prototype</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for better look in light mode */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #d1d5db; /* Light gray for the thumb */
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background-color: #f3f4f6; /* Very light background */
        }

        /* Specific classes for desktop collapse behavior */
        .left-panel-collapsed {
            /* On desktop, collapse width and border */
            width: 0 !important;
            border-right-width: 0 !important;
            overflow: hidden;
            /* Hide content immediately, important for the transition */
            opacity: 0; 
        }

        .right-panel-collapsed {
            /* On desktop, collapse width and border */
            width: 0 !important;
            border-left-width: 0 !important;
            overflow: hidden;
            /* Hide content immediately, important for the transition */
            opacity: 0;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 antialiased font-sans">

    <!-- Main Application Container -->
    <div id="app" class="flex h-screen overflow-hidden">

        <!-- Left Sidebar: Chat History and File Sources (Tabbed) -->
        <aside id="left-sidebar" 
               class="w-72 bg-white border-r border-gray-200 flex-shrink-0 transition-all duration-300 ease-in-out absolute inset-y-0 left-0 z-20 shadow-xl 
                      transform -translate-x-full md:translate-x-0 md:static md:w-72"
               data-state="open">
            
            <div class="p-4 flex items-center justify-between border-b border-gray-200">
                <h2 class="text-xl font-bold text-indigo-600">Context Console</h2>
                <button id="close-left-sidebar" class="md:hidden text-gray-500 hover:text-gray-800 p-1 rounded-full">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <!-- Tabs -->
            <div class="flex border-b border-gray-200">
                <button id="tab-history" class="tab-button w-1/2 py-2 text-sm font-medium text-center transition duration-150 ease-in-out border-b-2 border-transparent text-indigo-600 hover:text-indigo-500" data-target="history-panel">
                    History
                </button>
                <button id="tab-sources" class="tab-button w-1/2 py-2 text-sm font-medium text-center transition duration-150 ease-in-out border-b-2 border-transparent text-gray-500 hover:text-gray-600" data-target="sources-panel">
                    Sources
                </button>
            </div>

            <!-- Panel Content -->
            <div id="history-panel" class="p-4 h-full overflow-y-auto custom-scrollbar active-panel">
                <h3 class="text-lg font-semibold mb-3">Recent Sessions</h3>
                <div class="space-y-3 text-sm">
                    <a href="#" class="block p-3 bg-gray-100 rounded-lg hover:bg-gray-200 transition duration-150 border border-gray-200">
                        <p class="truncate font-semibold text-gray-800">Analyzing Q3 2024 Financials</p>
                        <p class="text-xs text-gray-500">12:30 PM, Today</p>
                    </a>
                    <a href="#" class="block p-3 bg-white rounded-lg hover:bg-gray-100 transition duration-150 border border-gray-200">
                        <p class="truncate text-gray-700">Drafting Marketing Strategy for X</p>
                        <p class="text-xs text-gray-500">Yesterday</p>
                    </a>
                    <a href="#" class="block p-3 bg-white rounded-lg hover:bg-gray-100 transition duration-150 border border-gray-200">
                        <p class="truncate text-gray-700">Brainstorming Product Names</p>
                        <p class="text-xs text-gray-500">2 days ago</p>
                    </a>
                    <p class="text-center text-gray-400 mt-6">... (Placeholder History List) ...</p>
                </div>
            </div>

            <div id="sources-panel" class="p-4 h-full overflow-y-auto custom-scrollbar hidden">
                <h3 class="text-lg font-semibold mb-3">Uploaded Files (Source Panel)</h3>
                <div class="space-y-3 text-sm">
                    <!-- File Source 1: PDF -->
                    <div class="p-3 border border-indigo-300 bg-gray-100 rounded-lg flex items-center space-x-2">
                        <!-- PDF Icon -->
                        <svg class="w-5 h-5 text-red-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path></svg> 
                        <div>
                            <p class="font-medium text-indigo-600">AnnualReport\_2023.pdf</p>
                            <p class="text-xs text-gray-500">2.4 MB - 120 Pages</p>
                        </div>
                    </div>
                    <!-- File Source 2: CSV/Spreadsheet -->
                    <div class="p-3 border border-gray-300 bg-white rounded-lg hover:bg-gray-100 transition duration-150 flex items-center space-x-2">
                        <!-- Spreadsheet Icon -->
                        <svg class="w-5 h-5 text-green-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                        <div>
                            <p class="font-medium text-gray-700">Market\_Data\_Q4.csv</p>
                            <p class="text-xs text-gray-500">0.8 MB</p>
                        </div>
                    </div>
                    <!-- File Source 3: TXT -->
                    <div class="p-3 border border-gray-300 bg-white rounded-lg hover:bg-gray-100 transition duration-150 flex items-center space-x-2">
                        <!-- Text File Icon -->
                        <svg class="w-5 h-5 text-blue-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        <div>
                            <p class="font-medium text-gray-700">User\_Feedback\_Notes.txt</p>
                            <p class="text-xs text-gray-500">0.1 MB</p>
                        </div>
                    </div>
                    <div class="mt-6">
                        <button class="w-full py-2 bg-indigo-600 hover:bg-indigo-700 rounded-xl font-medium text-white transition duration-150 shadow-md hover:shadow-lg">
                            + Upload New File
                        </button>
                    </div>
                </div>
            </div>

        </aside>

        <!-- Main Chat Area & Input Footer -->
        <main class="flex-1 flex flex-col min-w-0">

            <!-- Main Chat Header (Integrated Mobile/Desktop Toggles) -->
            <header class="p-4 bg-white border-b border-gray-200 flex items-center shadow-sm">
                <!-- Desktop Left Sidebar Toggle -->
                <button id="toggle-left-desktop" class="text-gray-500 hover:text-gray-800 p-1 rounded-full mr-4 hidden md:block transition duration-150" title="Toggle Context Console">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
                
                <h1 class="text-lg font-semibold text-gray-900 flex-1 text-center md:text-left">AI Assistant</h1>
                
                <!-- Mobile Left Sidebar Toggle -->
                <button id="open-left-sidebar" class="md:hidden text-gray-500 hover:text-gray-800 p-1 rounded-full" title="Open Context Console">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
            </header>

            <!-- Chat Messages Area (Content constrained by max-w-4xl) -->
            <div id="chat-area" class="flex-1 p-6 overflow-y-auto custom-scrollbar">
                <!-- Wrapper for centering/max-width -->
                <div class="max-w-4xl mx-auto space-y-8">
                    
                    <!-- Welcome Message -->
                    <div class="text-center pt-24 pb-12">
                        <h1 class="text-3xl font-extrabold text-gray-900 mb-2">Welcome to the Research Assistant</h1>
                        <p class="text-gray-500">Ask a question or upload a file to start a new session.</p>
                    </div>

                    <!-- Example User Message -->
                    <div class="flex justify-end">
                        <div class="max-w-xl p-4 rounded-xl rounded-br-none bg-indigo-600 text-white shadow-lg">
                            Can you summarize the main findings from the uploaded 'AnnualReport\_2023.pdf'? I also want to know the predicted market share.
                        </div>
                    </div>

                    <!-- Example AI Response -->
                    <div class="flex justify-start">
                        <div class="max-w-3xl p-4 rounded-xl rounded-tl-none bg-white border border-gray-200 shadow-md relative text-gray-800">
                            <p class="mb-3">Based on the analysis of <span class="text-indigo-600 font-semibold cursor-pointer">[Source 1]</span>, the company achieved record revenue growth of 18% year-over-year, driven primarily by the new 'Orion' product line.</p>
                            
                            <p class="mb-4">Regarding the market share, the report projects an increase from 12% to 15% within the next fiscal year. This projection is detailed in the competitive analysis section, specifically referenced in <span class="text-indigo-600 font-semibold cursor-pointer">[Source 2]</span>.</p>
                            
                            <div class="text-sm text-gray-500 border-t border-gray-200 pt-2 mt-2">
                                <p>To view detailed citations, click the 'Citations' button below.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Placeholder for more chat content -->
                    <div class="text-center text-gray-300 py-12">... Additional Chat Content Placeholder ...</div>
                </div>

            </div>

            <!-- Input Field and Action Buttons (Footer - Content constrained by max-w-4xl) -->
            <footer class="p-4 bg-white border-t border-gray-200 shadow-lg">
                <div class="max-w-4xl mx-auto flex flex-col md:flex-row items-center">
                    
                    <!-- Left action buttons -->
                    <div class="flex space-x-2 mb-2 md:mb-0 md:mr-4">
                        <button class="p-3 rounded-full bg-gray-200 hover:bg-gray-300 transition duration-150 text-gray-600" title="Upload File">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>
                        </button>
                        <!-- Button to toggle the Right Citation Panel -->
                        <button id="toggle-citations" class="p-3 rounded-full bg-indigo-600 hover:bg-indigo-700 transition duration-150 text-white font-medium shadow-md hover:shadow-lg">
                            Citations
                        </button>
                    </div>
                    
                    <!-- Input Field -->
                    <div class="flex-1 w-full md:w-auto relative">
                        <input type="text" placeholder="Type your message here..." class="w-full py-3 pl-4 pr-12 bg-white border border-gray-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 text-sm text-gray-900 placeholder-gray-500 shadow-sm">
                        <button class="absolute right-2 top-1/2 transform -translate-y-1/2 p-2 text-indigo-600 hover:text-indigo-500 transition duration-150">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                        </button>
                    </div>
                </div>
            </footer>

        </main>

        <!-- Right Sidebar: Citation Panel (Toggleable) -->
        <aside id="right-sidebar" 
               class="w-72 bg-white border-l border-gray-200 flex-shrink-0 transition-all duration-300 ease-in-out absolute inset-y-0 right-0 z-20 shadow-xl 
                      transform translate-x-full 
                      md:static md:w-72 md:border-l"
               data-state="collapsed">
            
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h2 class="text-xl font-bold text-green-600">Citations Panel</h2>
                <button id="close-citations" class="md:hidden text-gray-500 hover:text-gray-800 p-1 rounded-full">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            
            <div id="citation-content" class="p-4 h-full overflow-y-auto custom-scrollbar">
                <p class="text-gray-500 mb-4 text-sm">This panel shows detailed reference snippets and source locations used to generate the current AI response.</p>
                
                <!-- Citation 1 -->
                <div class="mb-4 p-4 bg-gray-100 rounded-lg shadow-sm border border-gray-200">
                    <span class="inline-block px-2 py-0.5 text-xs font-semibold bg-green-500 text-white rounded-full mb-2">Source 1</span>
                    <p class="text-sm font-medium text-green-700 mb-2">AnnualReport\_2023.pdf (Page 42)</p>
                    <blockquote class="text-sm border-l-4 border-green-500 pl-3 italic text-gray-700">
                        "Overall revenue for Q4 2024 totaled \$5.2 billion, marking an 18\% increase year-over-year. This success is directly attributable to the market acceptance and sales volume of the newly launched 'Orion' product line."
                    </blockquote>
                    <button class="mt-3 text-xs text-indigo-600 hover:underline">Go to Source Location</button>
                </div>

                <!-- Citation 2 -->
                <div class="mb-4 p-4 bg-gray-100 rounded-lg shadow-sm border border-gray-200">
                    <span class="inline-block px-2 py-0.5 text-xs font-semibold bg-green-500 text-white rounded-full mb-2">Source 2</span>
                    <p class="text-sm font-medium text-green-700 mb-2">Competitive Analysis Report (Section 3.1)</p>
                    <blockquote class="text-sm border-l-4 border-green-500 pl-3 italic text-gray-700">
                        "With sustained growth, our conservative projection is to capture 15\% of the total addressable market (TAM) by Q2 2025, up from the current 12\%."
                    </blockquote>
                    <button class="mt-3 text-xs text-indigo-600 hover:underline">Go to Source Location</button>
                </div>

                <div class="text-center text-gray-300 mt-6">... (More Citation Details) ...</div>
            </div>
        </aside>

    </div>

    <script>
        // --- Element Definitions ---
        const leftSidebar = document.getElementById('left-sidebar');
        const rightSidebar = document.getElementById('right-sidebar');
        const citationContent = document.getElementById('citation-content'); // Content area for right sidebar

        // Toggles
        const toggleCitationsButton = document.getElementById('toggle-citations');
        const toggleLeftDesktopButton = document.getElementById('toggle-left-desktop');
        const openLeftSidebarButton = document.getElementById('open-left-sidebar');
        const closeLeftSidebarButton = document.getElementById('close-left-sidebar');

        // Tabs
        const tabButtons = document.querySelectorAll('.tab-button');
        const historyPanel = document.getElementById('history-panel');
        const sourcesPanel = document.getElementById('sources-panel');

        // --- Core Sidebar Toggling Logic ---

        /**
         * Toggles the left sidebar open/closed on desktop.
         */
        function toggleLeftDesktop() {
            const is_open = leftSidebar.getAttribute('data-state') === 'open';

            if (is_open) {
                // Collapse state: apply custom CSS classes
                leftSidebar.classList.add('left-panel-collapsed');
                leftSidebar.setAttribute('data-state', 'collapsed');
                // Hide mobile toggle (optional, but clean)
                openLeftSidebarButton.style.display = 'none';
            } else {
                // Open state: remove custom CSS classes
                leftSidebar.classList.remove('left-panel-collapsed');
                leftSidebar.setAttribute('data-state', 'open');
                // Restore mobile toggle
                openLeftSidebarButton.style.display = '';
            }
        }

        /**
         * Toggles the right sidebar open/closed on both mobile and desktop.
         */
        function toggleRightSidebar() {
            const is_collapsed = rightSidebar.getAttribute('data-state') === 'collapsed';
            const isDesktop = window.innerWidth >= 768;

            if (is_collapsed) {
                // OPENING
                rightSidebar.setAttribute('data-state', 'open');
                
                // Remove mobile positioning class
                rightSidebar.classList.remove('translate-x-full');
                
                // Remove desktop collapse class
                if (isDesktop) {
                    rightSidebar.classList.remove('right-panel-collapsed');
                }
                
                // Ensure content is visible immediately
                citationContent.style.opacity = '1';
                
            } else {
                // COLLAPSING
                rightSidebar.setAttribute('data-state', 'collapsed');
                
                // Hide content instantly
                citationContent.style.opacity = '0';
                
                // Use a timeout to ensure opacity change registers before transition starts
                setTimeout(() => {
                    // Add mobile positioning class
                    rightSidebar.classList.add('translate-x-full');
                    
                    // Add desktop collapse class
                    if (isDesktop) {
                        rightSidebar.classList.add('right-panel-collapsed');
                    }
                }, 10); 
            }
        }
        
        // --- Event Listeners ---

        // 1. Desktop Left Sidebar Toggle
        toggleLeftDesktopButton.addEventListener('click', toggleLeftDesktop);

        // 2. Mobile Left Sidebar Toggles
        openLeftSidebarButton.addEventListener('click', () => {
            leftSidebar.classList.remove('-translate-x-full');
            leftSidebar.classList.add('translate-x-0');
        });
        closeLeftSidebarButton.addEventListener('click', () => {
            leftSidebar.classList.add('-translate-x-full');
            leftSidebar.classList.remove('translate-x-0');
        });

        // 3. Right Sidebar Toggles (using a single function for open/close)
        toggleCitationsButton.addEventListener('click', toggleRightSidebar);
        // Note: The mobile 'X' button is now handled by the generic toggleRightSidebar function
        document.getElementById('close-citations').addEventListener('click', toggleRightSidebar);


        // 4. Left Sidebar Tab Switching
        tabButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                // Deactivate all buttons/panels
                tabButtons.forEach(btn => {
                    btn.classList.remove('border-indigo-600', 'text-indigo-600');
                    btn.classList.add('border-transparent', 'text-gray-500');
                });
                historyPanel.classList.add('hidden');
                sourcesPanel.classList.add('hidden'); // Use Tailwind 'hidden' class

                // Activate clicked button
                e.currentTarget.classList.add('border-indigo-600', 'text-indigo-600');
                e.currentTarget.classList.remove('border-transparent', 'text-gray-500');

                // Show target panel
                const targetId = e.currentTarget.getAttribute('data-target');
                // Remove 'hidden' class to show the selected panel
                document.getElementById(targetId).classList.remove('hidden');
            });
        });

        // --- Initial State Setup ---

        // Initial setup for history tab
        document.getElementById('tab-history').classList.add('border-indigo-600', 'text-indigo-600');
        document.getElementById('tab-history').classList.remove('border-transparent', 'text-gray-500');
        historyPanel.classList.remove('hidden'); // Ensure history is visible initially

        // Initial setup for sources panel (ensure it's initially hidden using JS in case HTML defaults are missed)
        sourcesPanel.classList.add('hidden');

        // Initial setup for right sidebar collapsed state (Desktop)
        // Set the initial collapsed state classes on desktop where the media query doesn't apply the transform
        if (window.innerWidth >= 768) { 
            rightSidebar.classList.add('right-panel-collapsed');
            citationContent.style.opacity = '0';
        }

    </script>
</body>
</html>