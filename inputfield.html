<!-- filename: index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Input Field</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #242424; /* Dark background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .input-wrapper {
            position: relative;
            width: 1000px;
            max-width: 90%;
        }

        .sources-scroll-container {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 0;
            width: 350px;
            max-height: 260px;
            overflow-y: auto;
            overflow-x: hidden;
            z-index: 100;
            padding-right: 8px;
        }

        .sources-scroll-container::-webkit-scrollbar {
            width: 8px;
        }

        .sources-scroll-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .sources-scroll-container::-webkit-scrollbar-thumb {
            background: #555555;
            border-radius: 4px;
        }

        .sources-scroll-container::-webkit-scrollbar-thumb:hover {
            background: #666666;
        }

        .input-badge {
            position: absolute;
            top: -18px;
            left: 20px;
            background-color: #0078d4; /* Orange badge background */
            color: white;
            padding: 4px 12px;
            font-size: 0.8em;
            font-weight: 600;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            z-index: 10;
            line-height: 1;
        }

        .input-container {
            display: flex;
            align-items: center;
            background-color: #3C3C3C; /* Input field background */
            border: 2px solid #0078d4; /* Orange border */
            border-radius: 30px;
            padding: 8px 18px;
            box-sizing: border-box;
            min-height: 50px;
            position: relative;
        }

        .icon-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .svg-icon {
            fill: white;
            width: 24px;
            height: 24px;
        }
        .svg-icon.small {
            width: 20px;
            height: 20px;
        }
        .svg-icon.tiny {
            width: 16px;
            height: 16px;
        }

        .input-field {
            flex-grow: 1;
            background: none;
            border: none;
            outline: none;
            color: white;
            font-size: 1.1em;
            padding: 0 15px;
            line-height: 1.5;
            resize: none;
            overflow-y: auto;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        .input-field::placeholder {
            color: #AAAAAA;
            opacity: 1;
        }

        .input-field::-webkit-scrollbar {
            width: 8px;
        }

        .input-field::-webkit-scrollbar-track {
            background: transparent;
        }

        .input-field::-webkit-scrollbar-thumb {
            background: #555555;
            border-radius: 4px;
        }

        .input-field::-webkit-scrollbar-thumb:hover {
            background: #666666;
        }

        .mic-button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .wave-button {
            background-color: #0078D4; /* Blue button */
            border: none;
            border-radius: 50%;
            width: 38px;
            height: 38px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            flex-shrink: 0;
        }

        .link-button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .source-list {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 0;
            background-color: #2a2a2a;
            border: 2px solid #0078d4;
            border-radius: 12px;
            padding: 12px;
            width: 350px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .source-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #3C3C3C;
            border: 2px solid #0078d4;
            padding: 8px 18px;
            border-radius: 30px;
            font-size: 0.85em;
            color: white;
            width: 350px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }

        .source-item-content {
            display: flex;
            align-items: center;
            flex: 1;
            overflow: hidden;
        }

        .check-circle {
            width: 18px;
            height: 18px;
            border: 2px solid #0078d4;
            border-radius: 50%;
            margin-right: 10px;
            cursor: pointer;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: transparent;
        }

        .check-circle.checked {
            background-color: #0078d4;
        }

        .check-circle.checked::after {
            content: 'âœ“';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .source-item span {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-right: 8px;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #0078d4;
            cursor: pointer;
            font-size: 1.2em;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .source-input {
            background-color: #3C3C3C;
            border: 2px solid #0078d4;
            border-radius: 30px;
            padding: 8px 18px;
            color: white;
            font-size: 0.85em;
            outline: none;
            font-family: 'Segoe UI', Arial, sans-serif;
            box-sizing: border-box;
            width: 350px;
            margin-bottom: 10px;
        }

        .source-input:focus {
            border-color: #0078d4;
        }

        .source-indicator {
            position: absolute;
            top: -32px;
            left: 120px;
            background-color: #0078D4;
            color: white;
            padding: 4px 16px;
            font-size: 0.8em;
            font-weight: 600;
            border-radius: 12px;
            z-index: 10;
            line-height: 1;
        }
    </style>
</head>
<body>
    <div class="input-wrapper">
        <div class="input-container">
            <div id="sourceIndicator" class="source-indicator" style="display: none;">1 LINK ADDED</div>
            <button class="link-button" onclick="toggleSourcePopup()">
                <svg class="svg-icon tiny" viewBox="0 0 24 24" fill="white">
                    <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
                </svg>
            </button>
            <button class="mic-button">
                <svg class="svg-icon tiny" viewBox="0 0 24 24" fill="white">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                </svg>
            </button>
            <span class="icon-wrapper" style="margin-right: 10px;">
                <svg class="svg-icon" viewBox="0 0 24 24">
                    <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                </svg>
            </span>
            <textarea class="input-field" placeholder="Ask anything" rows="1" oninput="this.style.height='auto';this.style.height=Math.min(this.scrollHeight,230)+'px'"></textarea>
            <button class="wave-button">
                <svg class="svg-icon tiny" viewBox="0 0 24 24">
                    <path d="M6 10H3v4h3v6h2v-6h3v6h2v-6h3v6h2v-6h3V10h-3V4h-2v6h-3V4h-2v6H8V4H6v6z"/>
                </svg>
            </button>
        </div>
    </div>
    <script>
        let sourceLinks = [];
        let checkedLinks = [];
        let elements = [];
        
        function toggleSourcePopup() {
            const indicator = document.getElementById('sourceIndicator');
            if (elements.length === 0) {
                indicator.style.display = 'none';
                renderSourceList();
            } else {
                elements.forEach(el => el.remove());
                elements = [];
                updateIndicator();
            }
        }
        
        function handleInputKeydown(e) {
            if (e.key === 'Enter' && e.target.value.trim()) {
                sourceLinks.push(e.target.value.trim());
                checkedLinks.push(true);
                e.target.value = '';
                elements.forEach(el => el.remove());
                elements = [];
                renderSourceList();
            } else if (e.key === 'Escape') {
                toggleSourcePopup();
            }
        }
        
        function toggleCheck(index) {
            checkedLinks[index] = !checkedLinks[index];
            elements.forEach(el => el.remove());
            elements = [];
            renderSourceList();
        }

        function renderSourceList() {
            const wrapper = document.querySelector('.input-wrapper');
            
            const container = document.createElement('div');
            container.className = 'sources-scroll-container';
            
            sourceLinks.forEach((link, index) => {
                const item = document.createElement('div');
                item.className = 'source-item';
                item.innerHTML = `
                    <div class="source-item-content">
                        <div class="check-circle ${checkedLinks[index] ? 'checked' : ''}" onclick="toggleCheck(${index})"></div>
                        <span>${link}</span>
                    </div>
                    <button class="remove-btn" onclick="removeSource(${index})">&times;</button>
                `;
                container.appendChild(item);
            });
            
            const input = document.createElement('input');
            input.type = 'url';
            input.className = 'source-input';
            input.placeholder = 'Paste source link here...';
            input.addEventListener('keydown', handleInputKeydown);
            container.appendChild(input);
            
            wrapper.appendChild(container);
            elements.push(container);
            input.focus();
        }
        
        function removeSource(index) {
            sourceLinks.splice(index, 1);
            checkedLinks.splice(index, 1);
            elements.forEach(el => el.remove());
            elements = [];
            if (sourceLinks.length > 0 || elements.length === 0) {
                renderSourceList();
            }
            updateIndicator();
        }
        
        function updateIndicator() {
            const indicator = document.getElementById('sourceIndicator');
            const checkedCount = checkedLinks.filter(checked => checked).length;
            const totalCount = sourceLinks.length;
            if (checkedCount > 0) {
                indicator.textContent = checkedCount + '/' + totalCount + ' LINKS USED';
                indicator.style.display = 'block';
            } else {
                indicator.style.display = 'none';
            }
        }
    </script>
</body>
</html>